<!DOCTYPE html>
<html lang="ja" data-bs-theme="auto">
    <head>
        <meta charset="UTF-8">
        <meta name="google-site-verification" content="OC87FYYbTNU7c3Q1vn3qee5kXLtXMjotpx0iGK1ZPUU" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="/model/index/index.js"></script>
        <script src="/model/tips/tips.js"></script>

        <div id="styleList"></div>
        <link href="/css/loading.css" rel="stylesheet">
        <div class="loading-container" id="loadingScreen">
            <div class="loading"></div>
        </div>
        <script src="/view/loading.js"></script>
        <title>How to use Docker?</title>
    </head>
    <body>
        <div id="header-contents"></div>
        <div class="container pt-3">
            <main>
                <div class="row g-5">
                    <div class="col-md-8">
                        <h1 class="pt-4 mt-4 border-bottom fw-bold" id = "article_top">
                            Dockerの使い方ガイド
                        </h1>
                        <article class="blog-post">
                            <h3 class="pt-4 mt-4 border-bottom fw-bold" id = "docker">
                                概要
                            </h3>
                            <h4 class="pt-2 mt-2 fw-bold">
                                Docker (ドッカー)
                            </h4>
                            <ul>
                                <li>
                                    コンテナ仮想化技術を利用したオープンプラットフォーム
                                </li>
                                <li>
                                    アプリケーションの開発、デプロイ、実行を効率化出来る
                                </li>
                            </ul>

                            <h5 class="pt-3 mt-3 fw-bold">
                                メリット
                            </h5>
                            <ul>
                                <li>
                                    仮想環境であるため、隔離されており、実機に影響を及ぼしにくい
                                </li>
                                <li>
                                    VMよりも軽量
                                </li>
                                <li>
                                    起動や動作が速い
                                </li>
                                <li>
                                    開発環境の共有や移行が容易
                                </li>
                            </ul>
                        </article>
                        <article class="blog-post">
                            <h3 class="pt-4 mt-4 border-bottom fw-bold" id = "config">
                                Dockerで利用するファイル
                            </h3>
                            <p>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-fixed">
                                        <tr>
                                            <th scope="col">ファイル</th>
                                            <th scope="col">内容</th>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker-compose.yml</code></pre>
                                            </td>
                                            <td>
                                                複数コンテナの一括定義・連携
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">Dockerfile</code></pre>
                                            </td>
                                            <td class ="text-nowrap">
                                                <ul>
                                                    <li>
                                                        ベースイメージの指定
                                                    </li>
                                                    <li>
                                                        ポート指定 (情報提供のみで、実際のポートマッピングは<b>docker-compose.yml</b>で行う)
                                                    </li>
                                                    <li>
                                                        必要なソフトウェアのインストール
                                                    </li>
                                                    <li>
                                                        起動時に実行するコマンド等を指定
                                                    </li>
                                                </ul>
                                            </td>
                                        </tr>
                                        
                                    </table>
                                </div>
                                
                            </p>
                        </article>
                        <article class="blog-post">
                            <h3 class="pt-4 mt-4 border-bottom fw-bold" id = "cmd">
                                基本コマンド
                            </h3>
                            <p>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-fixed">
                                        <tr>
                                            <th scope="col">コマンド</th>
                                            <th scope="col">説明</th>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose up --build -d</code></pre>
                                            </td>
                                            <td class ="text-nowrap">
                                                Dockerfileに基づいてサービス用のDockerイメージを更新し、<br>
                                                バックグラウンドで全てのサービスを起動
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose up -d</code></pre>
                                            </td>
                                            <td>
                                                バックグラウンドで全てのサービスを起動
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose up</code></pre>
                                            </td>
                                            <td>
                                                全てのサービスをフォアグラウンドで起動し、ログを表示
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose build</code></pre>
                                            </td>
                                            <td>
                                                Dockerfileに基づいてサービス用のDockerイメージをビルド
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose exec [コンテナ名] [コマンド]</code></pre>
                                            </td>
                                            <td>
                                                既に実行中のコンテナ内で、新しいコマンドを実行する
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose run [コンテナ名] [コマンド]</code></pre>
                                            </td>
                                            <td>
                                                一度限りのコマンドを実行
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose down</code></pre>
                                            </td>
                                            <td>
                                                完全にコンテナを終了させる
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <pre><code class="language-bash">docker compose stop</code></pre>
                                            </td>
                                            <td>
                                                コンテナをサスペンドする
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                
                            </p>
                        </article>
                        <article class="blog-post">
                            <h3 class="pt-4 mt-4 border-bottom fw-bold" id = "sample">
                                サンプル
                            </h3>
                            <p>
                                <div class="fw-bold">
                                    .env
                                </div>
                                <pre><code class="language-bash"># 環境変数の設定
CONTAINER_NAME=linux
Dockerfile_DIR=.
Dockerfile=Dockerfile
TIME_ZONE=Asia/Tokyo
WS=WS
ENTRY_POINT=start.sh</code></pre>
                            </p>
                            <p>
                                <div class="fw-bold">
                                    docker-compose.yml
                                </div>
                                <pre><code class="language-yaml"># YAMLはスペース2つ
services: # 作成したいコンテナを列挙
  linux: # 機能名(任意の文字列)
    env_file: .env
    container_name: ${CONTAINER_NAME} # 作成するコンテナの名前
    build: 
      context: ${Dockerfile_DIR}
      dockerfile: ${Dockerfile} # Dockerfileへの相対パス
      args: # Dockerfile内の環境変数を設定
        WS: ${WS}
        CONTAINER_NAME: ${CONTAINER_NAME}
        ENTRY_POINT: ${ENTRY_POINT}
    
    # image: ubuntu:25.10 # Dockerfileが無い場合

    volumes: # マウント
      - ./linux_data:/home/${CONTAINER_NAME}/${WS} # ホストディレクトリ: コンテナ内ディレクトリ

    restart: no # unless-stopped always

    environment: # コンテナ内の環境変数を設定
      - TZ=${TIME_ZONE}
    
    ports: # ポートを接続
      - "3000:3000" # ホストマシンのポート番号:コンテナのポート番号
    
    # depends_on: # コンテナ間の依存関係を定義
    #   - db # 先にdbコンテナが動いていることを確認する

    # command: # サービスコンテナが起動したときに実行するコマンド
    #   - bash</code></pre>
                            </p>
                            <p>
                                <div class="fw-bold">
                                    Dockerfile
                                </div>
                                <pre><code class="language-bash"># FROM [イメージ] [タグ]
# Docker Hub (https://hub.docker.com/) 参照
FROM ubuntu:25.10

# 環境変数を docker-compose.yml から受け取る
ARG WS
ARG CONTAINER_NAME
ARG ENTRY_POINT

# RUN 命令はなるべく1つにまとめる
# コマンドが長くなる場合は \ で改行すること
RUN apt update && \
    apt upgrade -y && \
    apt install -y nano && \
    mkdir -p /home/${CONTAINER_NAME}/Programs

WORKDIR /home/${CONTAINER_NAME}/${WS}
COPY ${ENTRY_POINT} /home/${CONTAINER_NAME}/Programs/${ENTRY_POINT}
RUN chmod +x /home/${CONTAINER_NAME}/Programs/${ENTRY_POINT}

# 起動したら実行するコマンド
ENTRYPOINT ["/home/linux/Programs/start.sh"] 

# 起動したら実行するコマンド
# CMD ["/bin/bash", "-c", "while true; do sleep 1000; done"]
# 無限ループでbashを起動し続ける</code></pre>
                            </p>

                            <p>
                                <div class="fw-bold">
                                    start.sh
                                </div>
                                <pre><code class="language-bash">#!/usr/bin/env bash
while true; do
    sleep 1000 
done</code></pre>
                            </p>
                        </article>
                    
                    </div>
                    <div class="col-md-4">
                        <div class="position-sticky" style="top: 2rem;">
                            <div class="p-4">
                                <h4 class="fst-italic border-bottom">Table of Contents</h4>
                                <ol class="list-unstyled mb-0">
                                    <li>
                                        <a href="#article_top">Top</a>
                                    </li>
                                    <li>
                                        <a href="#docker">概要</a>
                                    </li>
                                    <li>
                                        <a href="#config">Dockerで利用するファイル</a>
                                    </li>
                                    <li>
                                        <a href="#cmd">基本コマンド</a>
                                    </li>
                                    <li>
                                        <a href="#sample">サンプル</a>
                                    </li>
                                </ol>
                            </div>
                            
                            <div id="tips"></div>
                        </div>
                    </div>
                </div>
            
            </main>
        </div>
    </body>
    <footer class="container border-top" id="footer-contents"> <!-- FOOTER -->
        <script src="/view/bootstrap.bundle.min.js"></script>
        <script src="/view/search.js"></script>
        <script src="/view/embeddedHTML.js"></script>
        <script src="/view/highlight.min.js"></script>
        <script src="/view/activenav.js"></script>
        <script src="/view/tips/tips.js"></script>
        <script src="/view/createTable.js"></script>
        <script>
            hljs.highlightAll();
            embedded_html("/template/styleConfig.html", "styleList");
            embedded_html("/template/header.html", "header-contents");
            embedded_html("/template/footer.html", "footer-contents");
            window.addEventListener("load", active_nav("tipsIndex"));
            new TipsView(tipsModel, "tips", "tips", ["linuxTip", "windowsTip", "vimTip", "serverTip"]);
        </script>
    </footer>
</html>
